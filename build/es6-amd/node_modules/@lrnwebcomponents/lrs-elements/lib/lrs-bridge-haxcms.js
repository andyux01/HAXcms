define(["exports", "../../../mobx/dist/mobx.esm.js", "../../haxcms-elements/lib/core/haxcms-site-store.js", "./lrs-bridge.js"], function (_exports, _mobxEsm, _haxcmsSiteStore, _lrsBridge) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.LrsBridgeHaxcms = void 0;

  /**
   * Copyright 2020 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */

  /**
   * `lrs-bridge-haxcms`
   * `Adds HAXcms event listeners for our LRS.`
   * @demo demo/index.html
   */
  class LrsBridgeHaxcms extends _lrsBridge.LrsBridge {
    constructor() {
      super();
      (0, _mobxEsm.autorun)(() => {
        this._locationChanged((0, _mobxEsm.toJS)(_haxcmsSiteStore.store.location));
      });
    }
    /**
     * Store the tag name to make it easier to obtain directly.
     * @notice function name must be here for tooling to operate correctly
     */


    static get tag() {
      return "lrs-bridge-haxcms";
    }

    _locationChanged(location) {
      // trim slash from begining and end
      const trimSlash = string => string.replace(/(^\/|\/$)/, "");

      const url = `${trimSlash(location.baseUrl)}/${trimSlash(location.pathname)}`;
      this.recordStatement({
        verb: {
          id: "viewed"
        },
        object: {
          id: url
        }
      });
    }

  }

  _exports.LrsBridgeHaxcms = LrsBridgeHaxcms;
  window.customElements.define(LrsBridgeHaxcms.tag, LrsBridgeHaxcms);
});