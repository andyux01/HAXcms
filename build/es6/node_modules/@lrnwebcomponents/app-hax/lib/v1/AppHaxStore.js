import{localStorageGet as t}from"../../../utils/utils.js";import{observable as e,makeObservable as s,computed as i,configure as a}from"../../../../mobx/dist/mobx.esm.js";import{DeviceDetails as l}from"../../../replace-tag/lib/PerformanceDetect.js";a({enforceActions:!1,useProxies:"ifavailable"});export const store=new class Store{constructor(){this.badDevice=null,this.evaluateBadDevice(),this.location=null,this.jwt=null,this.createSiteSteps=!1,this.appSettings=window.appSettings||{},this.sitesBase="https://iam.hax.psu.edu",this.AppHaxAPI={},this.newSitePromiseList=[()=>import("../../../i18n-manager/lib/I18NMixin.js"),()=>import("../../../wc-autoload/wc-autoload.js"),()=>import("../../../replace-tag/replace-tag.js"),()=>import("../../../utils/utils.js"),()=>import("../../../grid-plate/grid-plate.js"),()=>import("../../../../mobx/dist/mobx.esm.js"),()=>import("../../../simple-fields/simple-fields.js"),()=>import("../../../h-a-x/h-a-x.js")],this.appEl=null,this.appReady=!1,this.soundStatus=t("app-hax-soundStatus",!0),this.appMode="search",this.activeSiteOp=null,this.activeSiteId=null,this.routes=[],this.siteReady=!1,this.manifest={},this.searchTerm="",this.user={name:""},this.site=t("app-hax-site")?t("app-hax-site"):{structure:null,type:null,theme:null,name:null},this.step=this.stepTest(null),this.darkMode=!!t("app-hax-darkMode")&&t("app-hax-darkMode"),s(this,{location:e.ref,routes:e,sitesBase:e,appSettings:e,appReady:e,appMode:e,createSiteSteps:e,step:e,site:e,newSitePromiseList:e,jwt:e,manifest:e,user:e,searchTerm:e,darkMode:e,soundStatus:e,activeItem:i,isNewUser:i,isLoggedIn:i,badDevice:e,activeSiteOp:e,activeSiteId:e,activeSite:i,siteReady:e})}get activeSite(){if(this.activeSiteId&&this.manifest&&this.manifest.items){const t=this.manifest.items.filter((t=>t.id===this.activeSiteId));return 1===t.length?t.pop():null}}async evaluateBadDevice(){this.badDevice=await l.badDevice(),!0===this.badDevice&&(this.soundStatus=!1)}stepTest(t){return null===this.site.structure&&1!==t?1:null!==this.site.structure&&null===this.site.type&&2!==t?2:null!==this.site.structure&&null!==this.site.type&&null===this.site.theme&&3!==t?3:null!==this.site.structure&&null!==this.site.type&&null!==this.site.theme&&null===this.site.name&&4!==t?4:null!==this.site.structure&&null!==this.site.type&&null!==this.site.theme&&null!==this.site.name?5:t}get isLoggedIn(){return"null"!==this.jwt&&this.jwt}get isNewUser(){if(this.manifest&&this.manifest.items)return 0===this.manifest.items.length}get activeItem(){if(this.routes.length>0&&this.location&&this.location.route){if(this.createSiteSteps){return this.routes.find((t=>void 0!==t.step&&t.step===this.step))}return this.location.route}}toast(t,e=3e3,s={}){window.dispatchEvent(new CustomEvent("app-hax-toast-show",{bubbles:!0,cancelable:!0,composed:!0,detail:{text:t,duration:e,...s}}))}};